<!-- Wazuh Custom Rules for Vulnerability Detection -->
<!-- Source: https://williamzujkowski.github.io/posts/2025-10-06-automated-security-scanning-pipeline/ -->
<!-- Purpose: Define Wazuh rules for vulnerability alerting -->
<!-- Usage: Add to /var/ossec/etc/rules/local_rules.xml -->

<group name="vulnerability,">
  <rule id="100100" level="7">
    <decoded_as>json</decoded_as>
    <field name="vulnerability_id">\.+</field>
    <description>Vulnerability detected in container image</description>
  </rule>

  <rule id="100101" level="12">
    <if_sid>100100</if_sid>
    <field name="severity">CRITICAL</field>
    <description>Critical vulnerability detected: $(vulnerability_id)</description>
  </rule>

  <rule id="100102" level="10">
    <if_sid>100100</if_sid>
    <field name="severity">HIGH</field>
    <description>High severity vulnerability: $(vulnerability_id)</description>
  </rule>
</group>
