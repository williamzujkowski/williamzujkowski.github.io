{
  "comment": "Complete firewall rules for Zero Trust VLAN segmentation",
  "description": "Upload to GitHub gist and reference from blog post",
  "rules": [
    {
      "name": "Allow Management to All",
      "source_vlan": 10,
      "destination": "any",
      "action": "accept",
      "log": true,
      "comment": "Management VLAN has full access for administration"
    },
    {
      "name": "Block Trusted to Management",
      "source_vlan": 20,
      "destination_vlan": 10,
      "action": "drop",
      "log": true
    },
    {
      "name": "Allow Trusted to Servers",
      "source_vlan": 20,
      "destination_vlan": 30,
      "ports": [80, 443, 3306, 5432],
      "action": "accept"
    },
    {
      "name": "Block Servers to Trusted",
      "source_vlan": 30,
      "destination_vlan": 20,
      "action": "drop",
      "log": true
    },
    {
      "name": "Block IoT to All Internal",
      "source_vlan": 40,
      "destination": ["10.0.10.0/24", "10.0.20.0/24", "10.0.30.0/24"],
      "action": "drop",
      "log": true,
      "comment": "IoT devices isolated - internet only"
    },
    {
      "name": "Allow IoT to Internet",
      "source_vlan": 40,
      "destination": "internet",
      "action": "accept"
    },
    {
      "name": "Block Guest to All Internal",
      "source_vlan": 50,
      "destination": ["10.0.10.0/24", "10.0.20.0/24", "10.0.30.0/24", "10.0.40.0/24"],
      "action": "drop",
      "log": true
    },
    {
      "name": "Allow Guest to Internet",
      "source_vlan": 50,
      "destination": "internet",
      "ports": [80, 443],
      "action": "accept"
    }
  ],
  "default_policy": "drop",
  "logging": {
    "enabled": true,
    "level": "info",
    "destination": "syslog://10.0.10.5:514"
  }
}
