@import 'tailwindcss';

@config '../../../tailwind.config.js';

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility gradient-text {
  /* Gradient text */
  @apply bg-linear-to-r from-primary-600 to-primary-400 bg-clip-text text-transparent;
}

@utility glass {
  /* Glass morphism effect */
  @apply bg-white backdrop-blur-lg border border-gray-200 shadow-xl opacity-95;
}

@utility glass-dark {
  @apply bg-gray-900 backdrop-blur-lg border border-gray-700 shadow-xl opacity-95;
}

@utility hover-card {
  /* Hover card effect */
  @apply transition-all duration-300 hover:shadow-xl hover:-translate-y-1;
}

@utility focus-ring {
  /* Focus styles */
  @apply focus:outline-hidden focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900;
}

@utility focus-visible {
  /* Enhanced keyboard focus */
  &:focus {
    @apply outline-hidden ring-2 ring-primary-500 ring-offset-2 dark:ring-offset-gray-900;
  }
}

@utility btn {
  /* Button styles */
  @apply inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 focus-ring;
}

@utility btn-primary {
  @apply btn bg-primary-700 text-white hover:bg-primary-800 active:bg-primary-900 shadow-xs hover:shadow-md;
}

@utility btn-secondary {
  @apply btn bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 hover:bg-gray-300 dark:hover:bg-gray-600 active:bg-gray-400 dark:active:bg-gray-500;
}

@utility btn-ghost {
  @apply btn bg-transparent text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 active:bg-gray-200 dark:active:bg-gray-700;
}

@utility link {
  /* Link styles */
  @apply text-primary-600 hover:text-primary-700 underline underline-offset-2 decoration-primary-400 hover:decoration-primary-600 transition-all duration-200;
}

@utility code-block {
  /* Code blocks */
  @apply bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto;
}

@utility code-block-wrapper {
  /* Collapsible code blocks */
  @apply relative my-6;

  /* Copy button positioning fix for wrapped code blocks */
  & .code-copy-btn {
    z-index: 10;
  }
}

@utility code-block-container {
  @apply relative;

  /* Smooth transitions for code blocks */
  transition: max-height 0.3s ease-in-out;
}

@utility prose {
  /* Ensure proper dark mode for code blocks */
  & pre {
    @apply relative;
  }
}

@utility code-gradient-overlay {
  /* Style for collapsed code indicator */
  pointer-events: none;

  /* Dark mode adjustments for code buttons */
  .dark & {
    background: linear-gradient(transparent, rgba(17, 24, 39, 0.95)) !important;
  }
}

@utility dark {
  /* Dark mode adjustments for code buttons */
  & .code-gradient-overlay {
    background: linear-gradient(transparent, rgba(17, 24, 39, 0.95)) !important;
  }

  & .code-language-label {
    background: rgba(99, 102, 241, 0.1) !important;
    color: rgba(147, 187, 253, 0.95) !important;
    border-color: rgba(99, 102, 241, 0.2) !important;
  }
}

@utility code-copy-btn {
  /* Copy button positioning fix for wrapped code blocks */
  .code-block-wrapper & {
    z-index: 10;
  }
}

@utility code-language-label {
  /* Code language labels */
  @apply text-primary-600 dark:text-primary-400;

  .dark & {
    background: rgba(99, 102, 241, 0.1) !important;
    color: rgba(147, 187, 253, 0.95) !important;
    border-color: rgba(99, 102, 241, 0.2) !important;
  }
}

@utility section-spacing {
  /* Section spacing */
  @apply py-16 md:py-24 lg:py-32;
}

@utility text-balance {
  /* Text balance */
  text-wrap: balance;
}

@utility animation-delay-200 {
  /* Animation delays */
  animation-delay: 200ms;
}

@utility animation-delay-400 {
  animation-delay: 400ms;
}

@utility animation-delay-600 {
  animation-delay: 600ms;
}

/* Responsive enhancements are now included in enhancements.css */

@layer base {
  /* OKLCH Color Variables for perceptual uniformity */
  :root {
    /* Light mode colors */
    --clr-background-light: oklch(0.98 0.02 270);
    --clr-background-dark: oklch(0.12 0.03 270);
    --clr-text-light: oklch(0.1 0.02 90);
    --clr-text-dark: oklch(0.9 0.02 90);
    --clr-link-light: oklch(0.55 0.2 240);
    --clr-link-dark: oklch(0.75 0.15 240);
    
    /* Primary colors in OKLCH */
    --clr-primary-50: oklch(0.97 0.02 240);
    --clr-primary-100: oklch(0.93 0.04 240);
    --clr-primary-200: oklch(0.88 0.08 240);
    --clr-primary-300: oklch(0.81 0.12 240);
    --clr-primary-400: oklch(0.73 0.16 240);
    --clr-primary-500: oklch(0.62 0.2 240);
    --clr-primary-600: oklch(0.52 0.22 240);
    --clr-primary-700: oklch(0.45 0.2 240);
    --clr-primary-800: oklch(0.38 0.18 240);
    --clr-primary-900: oklch(0.32 0.14 240);
    --clr-primary-950: oklch(0.25 0.1 240);
    
    /* Typography scale */
    --font-scale-ratio: 1.2;
    --font-size-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
    --font-size-sm: clamp(0.875rem, 0.8rem + 0.375vw, 1rem);
    --font-size-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
    --font-size-lg: clamp(1.125rem, 1rem + 0.625vw, 1.25rem);
    --font-size-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
    --font-size-2xl: clamp(1.5rem, 1.3rem + 1vw, 1.875rem);
    --font-size-3xl: clamp(1.875rem, 1.6rem + 1.375vw, 2.25rem);
    --font-size-4xl: clamp(2.25rem, 1.9rem + 1.75vw, 3rem);
    --font-size-5xl: clamp(3rem, 2.5rem + 2.5vw, 3.75rem);
  }
  
  /* Inter font */
  @font-face {
    font-family: 'Inter';
    font-style: normal;
    font-weight: 100 900;
    font-display: swap;
    src: url('https://rsms.me/inter/inter.css') format('css');
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-gray-100;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-gray-400 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-500;
  }

  /* Selection colors */
  ::selection {
    @apply bg-primary-200 text-primary-900;
  }
}

/* Animations */
@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.animate-fade-in-up {
  animation: fade-in-up 0.6s ease-out;
}

.animate-fade-in {
  animation: fade-in 0.6s ease-out;
}

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  .animate-fade-in-up,
  .animate-fade-in {
    animation: none;
  }
  
  .transition-all,
  .transition-colors {
    transition: none;
  }
}

/* Mermaid diagram container styling */
.mermaid-container {
  @apply relative my-6 p-4 rounded-lg overflow-x-auto;
  @apply bg-gray-50 dark:bg-gray-800;
  @apply backdrop-blur-xs;
  @apply border border-gray-200 dark:border-gray-700;
  @apply shadow-xs hover:shadow-md transition-shadow duration-200;
}

.mermaid-container .mermaid {
  @apply flex justify-center items-center min-h-[200px];
}

/* Ensure Mermaid diagrams use consistent colors */
.mermaid svg {
  @apply max-w-full h-auto;
}

/* Dark mode Mermaid theme adjustments */
.dark .mermaid-container {
  /* Better contrast for dark mode */
  background: rgba(31, 41, 55, 0.5); /* gray-800 with opacity */
}

/* Table of Contents */
.toc-container {
  @apply hidden xl:block;
  position: absolute;
  left: calc(100% + 2rem);
  top: 0;
  width: 280px;
  max-height: calc(100vh - 120px);
  position: sticky;
  top: 100px;
}

.toc-content {
  @apply bg-white dark:bg-gray-800 rounded-lg p-4 shadow-xs border border-gray-200 dark:border-gray-700;
}

.toc-title {
  @apply text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 uppercase tracking-wider;
}

.toc-nav {
  @apply max-h-[calc(100vh-200px)] overflow-y-auto;
}

.toc-list {
  @apply space-y-1;
}

.toc-list-nested {
  @apply ml-4 mt-1 space-y-1;
}

.toc-item {
  @apply relative;
}

.toc-link {
  @apply block py-1 px-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 rounded-sm;
}

.toc-item-h3 .toc-link {
  @apply text-xs;
}

.toc-link-active {
  @apply text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-950;
}

/* Hide TOC on smaller screens */
@media (max-width: 1279px) {
  .toc-container {
    display: none;
  }
}

/* Search highlight animation */
.search-highlight {
  animation: highlight 0.3s ease-in-out;
}

@keyframes highlight {
  0% {
    transform: scale(1);
    opacity: 0.8;
  }
  50% {
    transform: scale(1.02);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Smooth transitions for search results */
.search-item {
  transition: all 0.3s ease-in-out;
}

/* Back to top button */
#back-to-top {
  @apply transform hover:scale-110 focus:scale-110;
  @apply focus:outline-hidden focus:ring-2 focus:ring-primary-500 focus:ring-offset-2;
}

#back-to-top.visible {
  @apply translate-y-0;
}

#back-to-top.invisible {
  @apply translate-y-20;
}